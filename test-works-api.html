<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö Works API</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .api-status {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: bold;
        }
        .api-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .api-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .api-loading {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .works-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .work-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .work-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .work-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .work-owner {
            color: #666;
            margin-bottom: 10px;
        }
        .work-category {
            background: #e9ecef;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            color: #495057;
            display: inline-block;
            margin-bottom: 5px;
        }
        .work-technique {
            color: #6c757d;
            font-size: 14px;
            margin-bottom: 10px;
        }
        .work-description {
            color: #495057;
            font-size: 14px;
            line-height: 1.4;
        }
        .pdf-link {
            color: #007bff;
            text-decoration: none;
            font-size: 14px;
        }
        .pdf-link:hover {
            text-decoration: underline;
        }
        .test-buttons {
            margin: 20px 0;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Works API</h1>
        <p>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå</p>
        
        <div class="test-buttons">
            <button class="test-button" onclick="testGetWorks()">üìã ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏á‡∏≤‡∏ô</button>
            <button class="test-button" onclick="testGetWorkById(1)">üîç ‡∏î‡∏∂‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô ID 1</button>
            <button class="test-button" onclick="testCreateWork()">‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
        </div>
        
        <div id="apiStatus"></div>
        <div id="worksContainer"></div>
    </div>

    <script>
        const API_BASE_URL = 'https://8e10ca7a2261.ngrok-free.app/api';
        
        function showStatus(message, type = 'loading') {
            const statusDiv = document.getElementById('apiStatus');
            statusDiv.innerHTML = `<div class="api-status api-${type}">${message}</div>`;
        }
        
        function displayWorks(works) {
            const container = document.getElementById('worksContainer');
            
            if (!works || works.length === 0) {
                container.innerHTML = '<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå</p>';
                return;
            }
            
            const worksHtml = works.map(work => `
                <div class="work-card">
                    <img 
                        src="${work.photo_url || 'https://via.placeholder.com/300x200?text=No+Image'}" 
                        alt="${work.name}"
                        class="work-image"
                        onerror="this.src='https://via.placeholder.com/300x200?text=Image+Error'"
                    />
                    <div class="work-title">${work.name}</div>
                    <div class="work-owner">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á: ${work.owner_name}</div>
                    ${work.category ? `<div class="work-category">${work.category}</div>` : ''}
                    ${work.technique ? `<div class="work-technique">‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ: ${work.technique}</div>` : ''}
                    ${work.description ? `<div class="work-description">${work.description}</div>` : ''}
                    ${work.pdf_url ? `<a href="${work.pdf_url}" target="_blank" class="pdf-link">üìÑ ‡∏î‡∏π‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ PDF</a>` : ''}
                    <div style="margin-top: 10px; font-size: 12px; color: #999;">
                        ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ${work.status} | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date(work.created_at).toLocaleDateString('th-TH')}
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = `
                <h3>üìã ‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå (${works.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h3>
                <div class="works-grid">
                    ${worksHtml}
                </div>
            `;
        }
        
        async function testGetWorks() {
            try {
                showStatus('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå...', 'loading');
                
                const response = await fetch(`${API_BASE_URL}/works?status=active`, {
                    headers: {
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                const result = await response.json();
                
                if (result.success) {
                    showStatus(`‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (${result.data.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)`, 'success');
                    displayWorks(result.data);
                } else {
                    showStatus(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${result.message}`, 'error');
                }
            } catch (error) {
                console.error('API Error:', error);
                showStatus(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ${error.message}`, 'error');
            }
        }
        
        async function testGetWorkById(id) {
            try {
                showStatus(`üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏á‡∏≤‡∏ô ID ${id}...`, 'loading');
                
                const response = await fetch(`${API_BASE_URL}/works/${id}`, {
                    headers: {
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                const result = await response.json();
                
                if (result.success) {
                    showStatus(`‚úÖ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏á‡∏≤‡∏ô ID ${id} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à`, 'success');
                    displayWorks([result.data]);
                } else {
                    showStatus(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${result.message}`, 'error');
                }
            } catch (error) {
                console.error('API Error:', error);
                showStatus(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ${error.message}`, 'error');
            }
        }
        
        async function testCreateWork() {
            try {
                showStatus('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà...', 'loading');
                
                const formData = new FormData();
                formData.append('name', '‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö API');
                formData.append('owner_name', '‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                formData.append('description', '‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö API');
                formData.append('category', '‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                formData.append('technique', '‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
                
                const response = await fetch(`${API_BASE_URL}/works`, {
                    method: 'POST',
                    headers: {
                        'ngrok-skip-browser-warning': 'true'
                    },
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showStatus('‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');
                    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
                    setTimeout(() => testGetWorks(), 1000);
                } else {
                    showStatus(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${result.message}`, 'error');
                }
            } catch (error) {
                console.error('API Error:', error);
                showStatus(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ${error.message}`, 'error');
            }
        }
        
        // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
        window.onload = function() {
            testGetWorks();
        };
    </script>
</body>
</html> 